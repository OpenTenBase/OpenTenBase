\c opentenbase_ora_package_function_regression_ora
-- test const
select bitand(123,67);
 BITAND 
--------
     67
(1 row)

select bitand(67,bitand(123,67));
 BITAND 
--------
     67
(1 row)

select bitand('123',67);
 BITAND 
--------
     67
(1 row)

select bitand(123,'67');
 BITAND 
--------
     67
(1 row)

select bitand('123','67');
 BITAND 
--------
     67
(1 row)

select bitand('67',bitand('123',67));
 BITAND 
--------
     67
(1 row)

-- test var
create table bitand_test(id int,c1 int,c2 bigint,c3 varchar(30),c4 text);
insert into bitand_test values(1,15,31,'63','127');
insert into bitand_test values(2,31,63,'127','255');
insert into bitand_test values(3,63,127,'255','511');
select id,bitand(c1,c2),bitand(c2,c3),bitand(c3,c4),bitand(c1,c3),bitand(c1,c4),bitand(c2,c4) from bitand_test order by id;
 ID | BITAND | BITAND | BITAND | BITAND | BITAND | BITAND 
----+--------+--------+--------+--------+--------+--------
  1 |     15 |     31 |     63 |     15 |     15 |     31
  2 |     31 |     63 |    127 |     31 |     31 |     63
  3 |     63 |    127 |    255 |     63 |     63 |    127
(3 rows)

-- test null
insert into bitand_test values(4,63,null,'',null);
select id,bitand(c1,c2),bitand(c2,c3),bitand(c3,c4),bitand(c1,c3),bitand(c1,c4),bitand(c2,c4) from bitand_test where id=4;
 ID | BITAND | BITAND | BITAND | BITAND | BITAND | BITAND 
----+--------+--------+--------+--------+--------+--------
  4 |        |        |        |        |        |       
(1 row)

select bitand('',c2),bitand(null,c3),bitand(c3,null),bitand(null,null),bitand(c1,''),bitand(c2,c4) from bitand_test;
 BITAND | BITAND | BITAND | BITAND | BITAND | BITAND 
--------+--------+--------+--------+--------+--------
        |        |        |        |        |     31
        |        |        |        |        |     63
        |        |        |        |        |    127
        |        |        |        |        |       
(4 rows)

-- test error
select bitand('1a',3);
ERROR:  invalid input syntax for type numeric: "1a"
CONTEXT:  SQL function "BITAND" statement 1
select bitand(3,'234a');
ERROR:  invalid input syntax for type numeric: "234a"
CONTEXT:  SQL function "BITAND" statement 1
insert into bitand_test values(5,63,null,'q','abc');
select id,bitand(c1,c2) from bitand_test where id=5;
 ID | BITAND 
----+--------
  5 |       
(1 row)

select id,bitand(c2,c3) from bitand_test where id=5;
ERROR:  invalid input syntax for type numeric: "q"
select id,bitand(c3,c4) from bitand_test where id=5;
ERROR:  invalid input syntax for type numeric: "q"
-- clean up
drop table bitand_test;
