\c regression_ora
set pg_stat_cluster_activity.enable_planstate TO off;
set NLS_DATE_FORMAT='YYYY-MM-DD HH24:MI:SS';
set NLS_TIMESTAMP_FORMAT='YYYY-MM-DD HH24:MI:SS.FF';
set NLS_TIMESTAMP_TZ_FORMAT='YYYY-MM-DD HH24.MI.SS.FF TZH:TZM';
set timezone='UTC';
drop table if exists tbl_date_20230206 cascade;
NOTICE:  table "TBL_DATE_20230206" does not exist, skipping
create table tbl_date_20230206(id int, c1 char(20), c2 nchar(100), c3 VARCHAR2(200), c4 NVARCHAR2(1000),
c5 NUMBER, c6 NUMBER(10, 3), c7 INTEGER, c8 BINARY_FLOAT, c9 BINARY_DOUBLE, c10 FLOAT(5),
c11 FLOAT(10), c12 DATE, c13 TIMESTAMP, c14 TIMESTAMP WITH TIME ZONE,
c15 INTERVAL YEAR TO MONTH, c16 interval day to second , c17 CLOB, c18 NCLOB ,
c19 BLOB, c20 long, c21 raw(100), c22 ROWID, c23 varchar2(50), c24 integer default 0);
insert into tbl_date_20230206 values(1, '2021-09-02 11:32:22', '2021-09-02 11:32:22.999999 +03:00', '2021-08-31 23:59:59.999999', '2021-08-31 23:59:59.999999 +08:00', 1, 2, 3, 3.5, 4.5, 5, 6,'2021-08-27 11:34:59', '2021-09-02 11:34:59.456123', '2021-09-02 11:34:59.456123 +08:00', interval '3 month', interval '1 second', '南山区', '深圳', 'TUESDAY', '深圳欢迎您', 'ABCD', '', '腾讯');
insert into tbl_date_20230206 values(2, '2021-02-28 11:32:22', '2021-09-03 23:59:59.999999 +08:00', '2021-09-30 23:59:59.999999', '2021-12-30 23:59:59.999999 +06:00', 7, 2, 3, 3.5, 4.5, 5, 6,'2021-08-27 11:34:59', '2021-09-02 11:34:59.456123', '2021-09-02 11:34:59.456123 +08:00', interval '3 month', interval '1 second', '杭州区', '杭州', 'Wednesday', '北京欢迎您', 'ABCF', '', '阿里巴巴');
insert into tbl_date_20230206 values(3, '2021-04-02 11:32:22', '2021-12-02 11:32:22.999999 +07:00', '2021-09-30 11:59:59.999999', '2021-08-30 23:59:59.999999 +01:00', 1, 6, 3, 1.5, 2.5, 5, 7,'2021-08-28 11:34:59', '2022-09-02 11:34:59.456123', '2022-09-02 11:34:59.456123 +08:00', interval '1 month', interval '10 minutes', '五环区', '北京', 'Thursday', '北京欢迎您', 'ABCF', '', '腾讯');
insert into tbl_date_20230206 values(4, '2021-06-02 11:32:22', '2021-07-02 11:32:22.999999 +03:00', '2021-09-30 23:59:59.999999', '2021-08-31 23:59:59.999999 +08:00', 1, 4, 3, 2.5, 1.5, 5, 5,'2021-08-27 11:34:59', '2021-09-02 11:34:59.456123', '2021-09-02 11:34:59.456123 +08:00', interval '2 year', interval '1 hour', '五环区','北京', 'Friday', '北京欢迎您', 'ABCF', '', '腾讯');
insert into tbl_date_20230206 values(5, '', '2021-07-02 11:32:22.999999 +03:00', '', '2021-08-31 23:59:59.999999 +08:00', 1, '', 3, '', 1.5, 5, '','2021-08-27 11:34:59', '', '', interval '2 year', interval '1 hour', '五环区','', 'Thursday', '', '', '', '');
insert into tbl_date_20230206 values(6, '2021-09-02 11:32:22', '', '2021-08-31 23:59:59.999999', '', 1, 2, 3, 3.5, 4.5, 5, 6,'2021-08-27 11:34:59', '', '', interval '3 month', '', '','北京', '', '', '', '', '腾讯');
select id, to_timestamp(c1, 'yyyy-mm-dd HH24:mi:ss.ff')         + c5 from tbl_date_20230206 order by id;
 ID |      ?column?       
----+---------------------
  1 | 2021-09-03 11:32:22
  2 | 2021-03-07 11:32:22
  3 | 2021-04-03 11:32:22
  4 | 2021-06-03 11:32:22
  5 | 
  6 | 2021-09-03 11:32:22
(6 rows)

select id, to_timestamp(c2, 'yyyy-mm-dd HH24:mi:ss.ff TZH:TZM') + c6 from tbl_date_20230206 order by id;
ERROR:  date format not recognized
select id, to_timestamp_tz(c2, 'yyyy-mm-dd HH24:mi:ss.ff TZH:TZM') + c6 from tbl_date_20230206 order by id;
 ID |      ?column?       
----+---------------------
  1 | 2021-09-04 11:32:22
  2 | 2021-09-05 23:59:59
  3 | 2021-12-08 11:32:22
  4 | 2021-07-06 11:32:22
  5 | 
  6 | 
(6 rows)

select id, to_timestamp(c3, 'yyyy-mm-dd HH24:mi:ss.ff')         + c7 from tbl_date_20230206 order by id;
 ID |      ?column?       
----+---------------------
  1 | 2021-09-03 23:59:59
  2 | 2021-10-03 23:59:59
  3 | 2021-10-03 11:59:59
  4 | 2021-10-03 23:59:59
  5 | 
  6 | 2021-09-03 23:59:59
(6 rows)

select id, to_timestamp(c4, 'yyyy-mm-dd HH24:mi:ss.ff TZH:TZM') + c5 from tbl_date_20230206 order by id;
ERROR:  date format not recognized
select id, to_timestamp_tz(c4, 'yyyy-mm-dd HH24:mi:ss.ff TZH:TZM') + c5 from tbl_date_20230206 order by id;
 ID |      ?column?       
----+---------------------
  1 | 2021-09-01 23:59:59
  2 | 2022-01-06 23:59:59
  3 | 2021-08-31 23:59:59
  4 | 2021-09-01 23:59:59
  5 | 2021-09-01 23:59:59
  6 | 
(6 rows)

select id, to_timestamp(c12, 'yyyy-mm-dd HH24:mi:ss.ff')        - c6 from tbl_date_20230206 order by id;
 ID |      ?column?       
----+---------------------
  1 | 2021-08-25 11:34:59
  2 | 2021-08-25 11:34:59
  3 | 2021-08-22 11:34:59
  4 | 2021-08-23 11:34:59
  5 | 
  6 | 2021-08-25 11:34:59
(6 rows)

select id, to_timestamp(c13, 'yyyy-mm-dd HH24:mi:ss.ff')        - c7 from tbl_date_20230206 order by id;
 ID |      ?column?       
----+---------------------
  1 | 2021-08-30 11:34:59
  2 | 2021-08-30 11:34:59
  3 | 2022-08-30 11:34:59
  4 | 2021-08-30 11:34:59
  5 | 
  6 | 
(6 rows)

/* -- START TAPD: 887262323 */
-- case 1: the output type of date operation '-' is number
create table tbl_date_test_20230904(d1 date, d2 date);
\d+ tbl_date_test_20230904;
                         Table "public.TBL_DATE_TEST_20230904"
 Column | Type | Collation | Nullable | Default | Storage | Stats target | Description 
--------+------+-----------+----------+---------+---------+--------------+-------------
 D1     | DATE |           |          |         | plain   |              | 
 D2     | DATE |           |          |         | plain   |              | 
Distribute By: HASH(D1)
Location Nodes: ALL DATANODES

insert into tbl_date_test_20230904 values('2023-09-1 18:21:14', '2023-09-2 19:21:15');
insert into tbl_date_test_20230904 values('2023-09-2 10:21:14', '2023-09-3 18:08:23');
select d2 - d1 from tbl_date_test_20230904 order by 1;
                 ?column?                 
------------------------------------------
 1.04167824074074074074074074074074074074
 1.32440972222222222222222222222222222222
(2 rows)

drop table tbl_date_test_20230904;
create table tbl_date_test_20230921(d1 date, d2 date);
\d+ tbl_date_test_20230921;
                         Table "public.TBL_DATE_TEST_20230921"
 Column | Type | Collation | Nullable | Default | Storage | Stats target | Description 
--------+------+-----------+----------+---------+---------+--------------+-------------
 D1     | DATE |           |          |         | plain   |              | 
 D2     | DATE |           |          |         | plain   |              | 
Distribute By: HASH(D1)
Location Nodes: ALL DATANODES

insert into tbl_date_test_20230921 values('2023-09-1 18:21:14', '2023-09-2 19:21:15');
insert into tbl_date_test_20230921 values('2023-09-2 10:21:14', '2023-09-3 18:08:23');
select d2 - d1 from tbl_date_test_20230921 order by 1;
                 ?column?                 
------------------------------------------
 1.04167824074074074074074074074074074074
 1.32440972222222222222222222222222222222
(2 rows)

drop table tbl_date_test_20230921;
create table tbl_date_20230922(id int, d date);
insert into tbl_date_20230922 values(1, to_date('2023-09-20', 'YYYY-MM-DD'));
insert into tbl_date_20230922 values(2, to_date('2023-09-21', 'YYYY-MM-DD'));
insert into tbl_date_20230922 values(3, to_date('2023-09-22', 'YYYY-MM-DD'));
-- case 2: date as parameter of function
create or replace function fn_date_20230922(d date) return number is
	t date;
begin
	select max(d) into t from tbl_date_20230922;
	return t - d;
end;
/
select fn_date_20230922(d) from tbl_date_20230922 order by 1;
 FN_DATE_20230922 
------------------
                0
                1
                2
(3 rows)

drop function fn_date_20230922;
drop table tbl_date_20230922;
-- case 3: alter date column of table
create table tbl_date_20230922_2(id int, d date);
\d+ tbl_date_20230922_2;
                            Table "public.TBL_DATE_20230922_2"
 Column |  Type   | Collation | Nullable | Default | Storage | Stats target | Description 
--------+---------+-----------+----------+---------+---------+--------------+-------------
 ID     | INTEGER |           |          |         | plain   |              | 
 D      | DATE    |           |          |         | plain   |              | 
Distribute By: HASH(ID)
Location Nodes: ALL DATANODES

alter table tbl_date_20230922_2 alter d type date;
\d+ tbl_date_20230922_2;
                            Table "public.TBL_DATE_20230922_2"
 Column |  Type   | Collation | Nullable | Default | Storage | Stats target | Description 
--------+---------+-----------+----------+---------+---------+--------------+-------------
 ID     | INTEGER |           |          |         | plain   |              | 
 D      | DATE    |           |          |         | plain   |              | 
Distribute By: HASH(ID)
Location Nodes: ALL DATANODES

/* -- END TAPD: 887262323 -- */
drop table tbl_date_20230206;
--test CC FMCC for to_char(DATE,FMT)
set nls_date_format = 'cc';
ERROR:  invalid value for parameter "nls_date_format": "cc"
DETAIL:  format code cannot appear in date input format
set nls_date_format = 'scc';
ERROR:  invalid value for parameter "nls_date_format": "scc"
DETAIL:  format code cannot appear in date input format
set nls_timestamp_format = 'cc';
ERROR:  invalid value for parameter "nls_timestamp_format": "cc"
DETAIL:  format code cannot appear in date input format
set nls_timestamp_format = 'scc';
ERROR:  invalid value for parameter "nls_timestamp_format": "scc"
DETAIL:  format code cannot appear in date input format
set nls_timestamp_tz_format = 'cc';
ERROR:  invalid value for parameter "nls_timestamp_tz_format": "cc"
DETAIL:  format code cannot appear in date input format
set nls_timestamp_tz_format = 'scc';
ERROR:  invalid value for parameter "nls_timestamp_tz_format": "scc"
DETAIL:  format code cannot appear in date input format
select to_char(to_date('2023-01-03 15:04:10', 'yyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS cc Cc cC CC') from dual;
             TO_CHAR             
---------------------------------
 2023-01-03 03:04:10 21 21 21 21
(1 row)

select to_char(to_date('2023-01-03 15:04:10', 'yyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS scc sCc scC sCC') from dual;
               TO_CHAR               
-------------------------------------
 2023-01-03 03:04:10  21  21  21  21
(1 row)

select to_char(to_date('bc2023-01-03 15:04:10', 'bcyyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS cc Cc cC CC') from dual;
             TO_CHAR             
---------------------------------
 2023-01-03 03:04:10 21 21 21 21
(1 row)

select to_char(to_date('bc2023-01-03 15:04:10', 'bcyyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS scc sCc scC sCC') from dual;
               TO_CHAR               
-------------------------------------
 2023-01-03 03:04:10 -21 -21 -21 -21
(1 row)

select to_char(to_date('40-01-03 15:04:10', 'yyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS cc Cc cC CC') from dual;
             TO_CHAR             
---------------------------------
 0040-01-03 03:04:10 01 01 01 01
(1 row)

select to_char(to_date('40-01-03 15:04:10', 'yyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS scc sCc scC sCC') from dual;
               TO_CHAR               
-------------------------------------
 0040-01-03 03:04:10  01  01  01  01
(1 row)

select to_char(to_date('bc40-01-03 15:04:10', 'bcyyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS cc Cc cC CC') from dual;
             TO_CHAR             
---------------------------------
 0040-01-03 03:04:10 01 01 01 01
(1 row)

select to_char(to_date('bc40-01-03 15:04:10', 'bcyyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS scc sCc scC sCC') from dual;
               TO_CHAR               
-------------------------------------
 0040-01-03 03:04:10 -01 -01 -01 -01
(1 row)

select to_char(to_date('40-01-03 15:04:10', 'yyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS cc fmCc cC CC') from dual;
           TO_CHAR            
------------------------------
 0040-01-03 03:04:10 01 1 1 1
(1 row)

select to_char(to_date('40-01-03 15:04:10', 'yyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS scc fmsCc scC sCC') from dual;
             TO_CHAR              
----------------------------------
 0040-01-03 03:04:10  01  1  1  1
(1 row)

select to_char(to_date('bc40-01-03 15:04:10', 'bcyyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS cc fmCc cC CC') from dual;
           TO_CHAR            
------------------------------
 0040-01-03 03:04:10 01 1 1 1
(1 row)

select to_char(to_date('bc40-01-03 15:04:10', 'bcyyyy-mm-dd hh24:mi:ss'), 'YyYy-Mm-dD hH12:Mi:sS scc fmsCc scC sCC') from dual;
             TO_CHAR              
----------------------------------
 0040-01-03 03:04:10 -01 -1 -1 -1
(1 row)

--test round date format CC
select to_char(round(to_date('bc1-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
  0001-01-01 00:00:00
(1 row)

select to_char(round(to_date('ad1-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
  0001-01-01 00:00:00
(1 row)

select to_char(round(to_date('bc150-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
 -0100-01-01 00:00:00
(1 row)

select to_char(round(to_date('ad150-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
  0101-01-01 00:00:00
(1 row)

select to_char(round(to_date('bc151-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
 -0200-01-01 00:00:00
(1 row)

select to_char(round(to_date('ad151-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
  0201-01-01 00:00:00
(1 row)

-- test trunc date format CC
select to_char(trunc(to_date('bc1-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
 -0100-01-01 00:00:00
(1 row)

select to_char(trunc(to_date('ad1-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
  0001-01-01 00:00:00
(1 row)

select to_char(trunc(to_date('bc150-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
 -0200-01-01 00:00:00
(1 row)

select to_char(trunc(to_date('ad150-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
  0101-01-01 00:00:00
(1 row)

select to_char(trunc(to_date('bc151-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
 -0200-01-01 00:00:00
(1 row)

select to_char(trunc(to_date('ad151-12-1 00:00:22','bcyyyy-mm-dd hh24:mi:ss'),'cc'), 'syyyy-mm-dd hh24:mi:ss') from dual;
       TO_CHAR        
----------------------
  0101-01-01 00:00:00
(1 row)

-- test use pg_catalog.timestamp and pg_catalog.timestamptz in opentenbase_ora mode
-- TAPD: 116163787 and 115605049
create table t_pg_ts_20240226(a int ,b int, c pg_catalog.timestamp, d pg_catalog.timestamp(2), e pg_catalog.timestamptz, f pg_catalog.timestamptz(3));
insert into t_pg_ts_20240226 values(1, 1, '2020-10-21 00:00:00.111', '2020-10-21 00:00:00.111', '2020-10-21 00:00:00.111', '2020-10-21 00:00:00.111');
create view v_pg_ts_20240226 as select * from t_pg_ts_20240226;
set enable_datanode_row_triggers to on;
create or replace trigger trg_pg_ts_20240226
INSTEAD OF INSERT OR UPDATE OR DELETE ON v_pg_ts_20240226
    FOR EACH ROW
BEGIN
 IF (TG_OP = 'DELETE') THEN
DELETE FROM t WHERE a = OLD.a;
IF NOT FOUND THEN RETURN NULL; END IF;
    OLD.c = '2020-10-21 00:00:00.111';
INSERT INTO t_pg_ts_20240226 VALUES(5, -1, OLD.c, OLD.c, OLD.c, OLD.c);
RETURN OLD;
ELSIF (TG_OP = 'UPDATE') THEN
UPDATE t_pg_ts_20240226 SET b = NEW.b WHERE a = OLD.a;
IF NOT FOUND THEN RETURN NULL; END IF;
    NEW.c = '2020-10-21 00:00:00.111';
INSERT INTO t_pg_ts_20240226 VALUES(6, 4, NEW.c, new.c, new.c, new.c);
RETURN NEW;
ELSIF (TG_OP = 'INSERT') THEN
    NEW.c = '2020-10-21 00:00:00.111';
INSERT INTO t_pg_ts_20240226 VALUES(7, 2, NEW.c, new.c. new.c, new.c);
RETURN NEW;
END IF;
end;
/
NOTICE:  trigger "TRG_PG_TS_20240226" for relation "V_PG_TS_20240226" does not exist, skipping
-- it is failed in 5.21.6.1, fix it
update v_pg_ts_20240226 set b = b * -1;
-- it is failed in 5.21.6.1, fix it
create table t_pg_ts_20240226_1 as select * from t_pg_ts_20240226;
drop trigger trg_pg_ts_20240226 on v_pg_ts_20240226;
drop view v_pg_ts_20240226;
drop table t_pg_ts_20240226_1;
drop table t_pg_ts_20240226;
reset enable_datanode_row_triggers;
-- test NUMTOYMINTERVAL
SET INTERVALSTYLE = 'sql_standard';
select NUMTOYMINTERVAL(10.8749999,'year') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000010-10
(1 row)

select NUMTOYMINTERVAL(10.875,'year') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000010-11
(1 row)

select NUMTOYMINTERVAL(10.874999999999999999999999999999999999999999999999999999999999999999999999999999999,'year') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000010-11
(1 row)

select NUMTOYMINTERVAL(0.00084,'year') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000000-01
(1 row)

select NUMTOYMINTERVAL(0.0008333333333,'year') from dual;
      NUMTOYMINTERVAL       
----------------------------
 +000000000 00:00:00.000000
(1 row)

select NUMTOYMINTERVAL(10.8749999,'month') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000000-11
(1 row)

select NUMTOYMINTERVAL(10.49999999,'month') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000000-10
(1 row)

select NUMTOYMINTERVAL(10.49999999999999999999999999999999999999999999999999999999999999999999999999999999,'month') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000000-11
(1 row)

select NUMTOYMINTERVAL(0.5,'month') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000000-01
(1 row)

select NUMTOYMINTERVAL(0.49,'month') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000000-01
(1 row)

select NUMTOYMINTERVAL(0.01,'month') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000000-01
(1 row)

select NUMTOYMINTERVAL(0.0099999999999999999999999999,'month') from dual;
      NUMTOYMINTERVAL       
----------------------------
 +000000000 00:00:00.000000
(1 row)

select NUMTOYMINTERVAL(0.00999999999999999999999999999999999999999999999999999999999999999999999999999999999999,'month') from dual;
 NUMTOYMINTERVAL 
-----------------
 +000000000-01
(1 row)

SELECT NUMTOYMINTERVAL(1, CASE WHEN MOD(EXTRACT(MONTH FROM to_date('2023-02-11 12:13:14', 'YYYY-MM-DD HH24-Mi-SS')), 2) = 0 THEN 'MONTH' ELSE 'YEAR' END) AS dynamic_interval FROM DUAL;
 DYNAMIC_INTERVAL 
------------------
 +000000000-01
(1 row)

SELECT NUMTOYMINTERVAL(EXTRACT(YEAR FROM to_date('2023-02-11 12:13:14', 'YYYY-MM-DD HH24-Mi-SS')), 'YEAR') AS date_in_future FROM DUAL;
 DATE_IN_FUTURE 
----------------
 +000002023-00
(1 row)

SELECT NUMTOYMINTERVAL(EXTRACT(MONTH FROM to_date('2023-02-11 12:13:14', 'YYYY-MM-DD HH24-Mi-SS')) * 2, 'MONTH') AS interval_months FROM DUAL;
 INTERVAL_MONTHS 
-----------------
 +000000000-04
(1 row)

select NUMTOYMINTERVAL(NULL,'month') from dual;
 NUMTOYMINTERVAL 
-----------------
 
(1 row)

select NUMTOYMINTERVAL(NULL,NULL) from dual;
 NUMTOYMINTERVAL 
-----------------
 
(1 row)

select NUMTOYMINTERVAL(1,'') from dual;
 NUMTOYMINTERVAL 
-----------------
 
(1 row)

select NUMTOYMINTERVAL(NULL,'') from dual;
 NUMTOYMINTERVAL 
-----------------
 
(1 row)

-- test MONTHS_BETWEEN
select months_between('2024-01-03','2023-01-01 2:0:0') from dual;
              MONTHS_BETWEEN               
-------------------------------------------
 12.06182795698924731182795698924731182796
(1 row)

select months_between('2024-01-03 4:0:11','2023-01-01 2:0:0') from dual;
              MONTHS_BETWEEN               
-------------------------------------------
 12.06720840800477897252090800477897252091
(1 row)

select months_between(NULL,'2023-01-01 2:0:0') from dual;
 MONTHS_BETWEEN 
----------------
               
(1 row)

select months_between('2024-01-03 4:0:11',NULL) from dual;
 MONTHS_BETWEEN 
----------------
               
(1 row)

select months_between('2024-12-31 23:59:59','-4712-01-01 2:0:0') from dual;
ERROR:  (full) year must be between -4713 and +9999, and not be 0
LINE 1: select months_between('2024-12-31 23:59:59','-4712-01-01 2:0...
                                                    ^
select months_between('2024-12-31 23:59:59','99999-01-01 2:0:0') from dual;
ERROR:  literal does not match format string
LINE 1: select months_between('2024-12-31 23:59:59','99999-01-01 2:0...
                                                    ^
select months_between('-4712-12-31 23:59:59','2023-01-01 2:0:0') from dual;
ERROR:  (full) year must be between -4713 and +9999, and not be 0
LINE 1: select months_between('-4712-12-31 23:59:59','2023-01-01 2:0...
                              ^
select months_between('99999-12-31 23:59:59','2023-01-01 2:0:0') from dual;
ERROR:  literal does not match format string
LINE 1: select months_between('99999-12-31 23:59:59','2023-01-01 2:0...
                              ^
SELECT MONTHS_BETWEEN(TO_DATE('2024-12-31', 'YYYY-MM-DD'), 
                      TO_DATE('2023-01-01', 'YYYY-MM-DD') + 30) AS months_diff FROM dual;
 MONTHS_DIFF 
-------------
          23
(1 row)

SELECT MONTHS_BETWEEN(TO_DATE('2023-01-01', 'YYYY-MM-DD'), TO_DATE('1990-05-15', 'YYYY-MM-DD'))/12 AS age FROM dual;
                    AGE                    
-------------------------------------------
 32.62903225806451612903225806451612903225
(1 row)

SELECT MONTHS_BETWEEN(TO_DATE('2023-01-01', 'YYYY-MM-DD') - 45, TO_DATE('2025-09-01', 'YYYY-MM-DD') - 90) AS months_diff FROM dual;
                MONTHS_DIFF                
-------------------------------------------
 -30.5483870967741935483870967741935483871
(1 row)

SELECT MONTHS_BETWEEN(
         TO_DATE('2023-01-01', 'YYYY-MM-DD'), 
         CASE 
           WHEN TO_CHAR(TO_DATE('2023-01-01', 'YYYY-MM-DD'), 'MM') BETWEEN '01' AND '06' THEN 
             TO_DATE(TO_CHAR(TO_DATE('2023-01-01', 'YYYY-MM-DD'), 'YYYY') || '-01-01', 'YYYY-MM-DD')
           ELSE 
             TO_DATE(TO_CHAR(TO_DATE('2023-01-01', 'YYYY-MM-DD'), 'YYYY') || '-07-01', 'YYYY-MM-DD')
         END
       ) AS months_diff
FROM dual;
 MONTHS_DIFF 
-------------
           0
(1 row)

select to_char(to_date('9999-12-31 0:0:0', 'yyyy-mm-dd hh24:mi:ss'), 'A.d. yyyy-mm-dd hh24:mi:ss') from dual;
         TO_CHAR          
--------------------------
 A.D. 9999-12-31 00:00:00
(1 row)

select to_char(to_date('9999-12-31 0:0:0', 'yyyy-mm-dd hh24:mi:ss'), 'B.c. yyyy-mm-dd hh24:mi:ss') from dual;
         TO_CHAR          
--------------------------
 A.D. 9999-12-31 00:00:00
(1 row)

select to_char(to_date('9999-12-31 0:0:0', 'yyyy-mm-dd hh24:mi:ss'), 'Ad yyyy-mm-dd hh24:mi:ss') from dual;
        TO_CHAR         
------------------------
 Ad 9999-12-31 00:00:00
(1 row)

select to_char(to_date('9999-12-31 0:0:0', 'yyyy-mm-dd hh24:mi:ss'), 'Bc yyyy-mm-dd hh24:mi:ss') from dual;
        TO_CHAR         
------------------------
 Ad 9999-12-31 00:00:00
(1 row)

select months_between(to_date('2023-02-28 23:59:59', 'YYYY-MM-DD HH24:MI:SS'), to_date('2022-01-9 08:00:00', 'YYYY-MM-DD HH24:MI:SS')) from dual;
              MONTHS_BETWEEN               
-------------------------------------------
 13.63440822879330943847072879330943847073
(1 row)

select months_between(to_date('2023-02-28 23:59:59', 'YYYY-MM-DD HH24:MI:SS'), to_date('2024-01-29 08:00:00', 'YYYY-MM-DD HH24:MI:SS')) from dual;
               MONTHS_BETWEEN               
--------------------------------------------
 -11.01075306152927120669056152927120669056
(1 row)

select months_between(to_date('2023-02-28 23:59:59', 'YYYY-MM-DD HH24:MI:SS'), to_date('2024-01-29 00:00:00', 'YYYY-MM-DD HH24:MI:SS')) from dual;
               MONTHS_BETWEEN               
--------------------------------------------
 -11.00000037335722819593787335722819593787
(1 row)

select months_between(to_date('2023-02-28 23:59:59', 'YYYY-MM-DD HH24:MI:SS'), to_date('2024-02-29 00:00:00', 'YYYY-MM-DD HH24:MI:SS')) from dual;
 MONTHS_BETWEEN 
----------------
            -12
(1 row)

select months_between(to_date('2024-02-28 23:59:59', 'YYYY-MM-DD HH24:MI:SS'), to_date('2024-02-29 00:00:00', 'YYYY-MM-DD HH24:MI:SS')) from dual;
                  MONTHS_BETWEEN                  
--------------------------------------------------
 -.0000003733572281959378733572281959378733572282
(1 row)

select months_between(to_date('2024-02-28 23:59:59', 'YYYY-MM-DD HH24:MI:SS'), to_date('2024-03-02 00:00:00', 'YYYY-MM-DD HH24:MI:SS')) from dual;
               MONTHS_BETWEEN               
--------------------------------------------
 -.1290326314217443249701314217443249701314
(1 row)

set nls_date_format = 'syyyy-mm-dd hh:mi:ss';
set nls_timestamp_format = 'syyyy-mm-dd hh:mi:ssxff';
set nls_timestamp_tz_format = 'syyyy-mm-dd hh:mi:ssxff tzh:tzm';
select date '2024-05-29' from dual;
  DATE_DEF_FMT_ORCL   
----------------------
  2024-05-29 12:00:00
(1 row)

select date '2024-05-29 14:29:17' from dual;
  DATE_DEF_FMT_ORCL   
----------------------
  2024-05-29 02:29:17
(1 row)

select date '2024-05' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select date '2024-05-29 14:29' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select date '2024-05-29 14:29:11.156841' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select date '024-5-9 14:29:11' from dual;
  DATE_DEF_FMT_ORCL   
----------------------
  0024-05-09 02:29:11
(1 row)

select date '-024-5-9' from dual;
  DATE_DEF_FMT_ORCL   
----------------------
 -0024-05-09 12:00:00
(1 row)

select date '- 1024 - 5 - 9 14 : 29 : 11' from dual;
  DATE_DEF_FMT_ORCL   
----------------------
 -1024-05-09 02:29:11
(1 row)

select date '2023-2-29' from dual; -- error, day of month must be between 1 and last day of month
ERROR:  day of month must be between 1 and last day of month
select date '2024-4-31' from dual; -- error, day of month must be between 1 and last day of month
ERROR:  day of month must be between 1 and last day of month
select timestamp '2019-09-19 12:12:12' from dual;
     TIMESTAMP_DEF_FMT_ORCL     
--------------------------------
  2019-09-19 12:12:12.000000000
(1 row)

select timestamp '2019-09-19' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamp '2019-09' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamp '2019-09-19 12:12:12.' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamp '2019-09-19 12:12' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamp '2019-09-19 12:12:12.798' from dual;
     TIMESTAMP_DEF_FMT_ORCL     
--------------------------------
  2019-09-19 12:12:12.798000000
(1 row)

select timestamp '9-9-9 1:1:1.7' from dual;
     TIMESTAMP_DEF_FMT_ORCL     
--------------------------------
  0009-09-09 01:01:01.700000000
(1 row)

select timestamp '- 1024 - 5 - 9 14 : 29 : 11 . 153' from dual;
     TIMESTAMP_DEF_FMT_ORCL     
--------------------------------
 -1024-05-09 02:29:11.153000000
(1 row)

select timestampltz '2019-09-19 12:12:12' from dual;
   TIMESTAMPLTZ_DEF_FMT_ORCL    
--------------------------------
  2019-09-19 12:12:12.000000000
(1 row)

select timestampltz '2019-09-19' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestampltz '2019-09' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestampltz '2019-09-19 12:12:12.' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestampltz '2019-09-19 12:12' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestampltz '2019-09-19 12:12:12.798' from dual;
   TIMESTAMPLTZ_DEF_FMT_ORCL    
--------------------------------
  2019-09-19 12:12:12.798000000
(1 row)

select timestampltz '9-9-9 1:1:1.7' from dual;
   TIMESTAMPLTZ_DEF_FMT_ORCL    
--------------------------------
  0009-09-09 01:01:01.700000000
(1 row)

select timestampltz '- 1024 - 5 - 9 14 : 29 : 11 . 153' from dual;
   TIMESTAMPLTZ_DEF_FMT_ORCL    
--------------------------------
 -1024-05-09 02:29:11.153000000
(1 row)

select timestamptz '2019-09-19' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamptz '2019-09-19 12:12:12' from dual;
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
  2019-09-19 12:12:12.000000000 +00:00
(1 row)

select timestamptz '2019-09-19 12:12:12 +08:00' from dual;
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
  2019-09-19 12:12:12.000000000 +08:00
(1 row)

select timestamptz '2019-09-19 12:12:12 PRC' from dual;
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
  2019-09-19 12:12:12.000000000 +08:00
(1 row)

select timestamptz '2019-09-19 12:12:12. +08:00' from dual; -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamptz '-0001 - 9 - 9 9:7:1 + 08 : 00' from dual;
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
 -0001-09-09 09:07:01.000000000 +08:00
(1 row)

select date_def_fmt_orcl('2024-5-9');
  DATE_DEF_FMT_ORCL   
----------------------
  2024-05-09 12:00:00
(1 row)

select date_def_fmt_orcl('2024-5-9 4:2:1');
  DATE_DEF_FMT_ORCL   
----------------------
  2024-05-09 04:02:01
(1 row)

select date_def_fmt_orcl('-2024-5-9 4:2:1');
  DATE_DEF_FMT_ORCL   
----------------------
 -2024-05-09 04:02:01
(1 row)

select date_def_fmt_orcl('-2024-5'); -- error, literal does not match format string
ERROR:  literal does not match format string
select date_def_fmt_orcl('-2024-5-9 4:2'); -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamp_def_fmt_orcl('2024-5-9 4:2:1');
     TIMESTAMP_DEF_FMT_ORCL     
--------------------------------
  2024-05-09 04:02:01.000000000
(1 row)

select timestamp_def_fmt_orcl('2024-5-9 4:2:1.177');
     TIMESTAMP_DEF_FMT_ORCL     
--------------------------------
  2024-05-09 04:02:01.177000000
(1 row)

select timestamp_def_fmt_orcl('-2024-5-9 4:2:1');
     TIMESTAMP_DEF_FMT_ORCL     
--------------------------------
 -2024-05-09 04:02:01.000000000
(1 row)

select timestamp_def_fmt_orcl('-2024-5-9 4:2'); -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamp_def_fmt_orcl('2024-5-9 4:2:1.'); -- error, literal does not match format string
ERROR:  literal does not match format string
select timestampltz_def_fmt_orcl('2024-5-9 4:2:1');
   TIMESTAMPLTZ_DEF_FMT_ORCL    
--------------------------------
  2024-05-09 04:02:01.000000000
(1 row)

select timestampltz_def_fmt_orcl('2024-5-9 4:2:1.177');
   TIMESTAMPLTZ_DEF_FMT_ORCL    
--------------------------------
  2024-05-09 04:02:01.177000000
(1 row)

select timestampltz_def_fmt_orcl('-2024-5-9 4:2:1');
   TIMESTAMPLTZ_DEF_FMT_ORCL    
--------------------------------
 -2024-05-09 04:02:01.000000000
(1 row)

select timestampltz_def_fmt_orcl('-2024-5-9 4:2'); -- error, literal does not match format string
ERROR:  literal does not match format string
select timestampltz_def_fmt_orcl('2024-5-9 4:2:1.'); -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamptz_def_fmt_orcl('2024-5-9 4:2:1');
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
  2024-05-09 04:02:01.000000000 +00:00
(1 row)

select timestamptz_def_fmt_orcl('2024-5-9 4:2:1.177 PRC');
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
  2024-05-09 04:02:01.177000000 +08:00
(1 row)

select timestamptz_def_fmt_orcl('-2024-5-9 4:2:1 +8:15');
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
 -2024-05-09 04:02:01.000000000 +08:15
(1 row)

select timestamptz_def_fmt_orcl('- 2024 - 5 - 9 4 : 2 : 1 PST8PDT');
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
 -2024-05-09 04:02:01.000000000 -08:00
(1 row)

select timestamptz_def_fmt_orcl('- 2024 - 5 - 9 4 : 2 : 1 . 147 +8:15');
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
 -2024-05-09 04:02:01.147000000 +08:15
(1 row)

select timestamptz_def_fmt_orcl('- 2024 - 5 - 9 4 : 2 : 1 . 88 PST8PDT');
       TIMESTAMPTZ_DEF_FMT_ORCL        
---------------------------------------
 -2024-05-09 04:02:01.880000000 -08:00
(1 row)

select timestamptz_def_fmt_orcl('-2024-5-9 4:2'); -- error, literal does not match format string
ERROR:  literal does not match format string
select timestamptz_def_fmt_orcl('2024-5-9 4:2:1.'); -- error, literal does not match format string
ERROR:  literal does not match format string
reset nls_date_format;
reset nls_timestamp_format;
reset nls_timestamp_tz_format;
select greatest(timestamp '2000-09-19 11:12:13', to_timestamp('2008-08-18','yyyy-mm-dd')) from dual;
           greatest            
-------------------------------
 2008-08-18 00:00:00.000000000
(1 row)

select greatest(cast('2000-09-19 11:12:13' as timestamp(2)), to_timestamp('2008-08-18','yyyy-mm-dd')) from dual;
        greatest        
------------------------
 2008-08-18 00:00:00.00
(1 row)

select greatest(timestamp(7) '2000-09-19 11:12:13.155189814', to_timestamp('2018-08-18','yyyy-mm-dd')) from dual;
           greatest            
-------------------------------
 2018-08-18 00:00:00.000000000
(1 row)

select greatest(timestampltz(5) '2000-09-19 11:12:13.155189814', to_timestamp('2018-08-18','yyyy-mm-dd')) from dual;
         greatest          
---------------------------
 2018-08-18 00:00:00.00000
(1 row)

select greatest(timestampltz(0) '2000-09-19 11:12:13.155189814', to_timestamp('2018-08-18','yyyy-mm-dd')) from dual;
      greatest       
---------------------
 2018-08-18 00:00:00
(1 row)

select greatest('2000-09-19 11:12:13.15 +07:30'::timestamptz(0), to_timestamp('2018-08-18','yyyy-mm-dd')) from dual;
          greatest          
----------------------------
 2018-08-18 00:00:00 +00:00
(1 row)

select greatest('2000-09-19 11:12:13.15 +07:30'::timestamptz(8), to_timestamp('2018-08-18','yyyy-mm-dd')) from dual;
              greatest               
-------------------------------------
 2018-08-18 00:00:00.00000000 +00:00
(1 row)

select greatest(to_timestamp('2020-1-1 1:1:1'), to_timestamp_tz('2023-1-1 1:1:1.158745881 +08:00'));
           greatest            
-------------------------------
 2023-01-01 01:01:01.158745881
(1 row)

select least(localtimestamp,sysdate,to_timestamp('2008-08-18','yyyy-mm-dd')::timestamp(1));
           least            
----------------------------
 2008-08-18 00:00:00.000000
(1 row)

select least(localtimestamp(2),sysdate,to_timestamp('2008-08-18','yyyy-mm-dd')::timestampltz(7));
         least          
------------------------
 2008-08-18 00:00:00.00
(1 row)

select least(localtimestamp(5),sysdate,to_timestamp_tz('2008-08-18.979476951 -04:00','yyyy-mm-dd.ff tzh:tzm')::timestamptz(8));
           least           
---------------------------
 2008-08-18 00:00:00.97948
(1 row)

select least(to_timestamp('2020-1-1 1:1:1'), to_timestamp_tz('2008-1-1 1:1:1.158745881 +08:00'));
             least             
-------------------------------
 2008-01-01 01:01:01.158745881
(1 row)

select timestamp '2012-1-1 1:1:1 + 00 : 10' from dual;
       TIMESTAMPTZ_DEF_FMT_ORCL       
--------------------------------------
 2012-01-01 01:01:01.000000000 +00:10
(1 row)

select timestamp '2012-1-1 1:1:1 + 0010' from dual; -- time zone hour must be between -15 and 15
ERROR:  time zone hour must be between -15 and 15
select timestamp '2012-1-1 1:1:1 + 0010' from dual; -- time zone hour must be between -15 and 15
ERROR:  time zone hour must be between -15 and 15
select timestamp '2012-1-1 1:1:1 00 : 10' from dual; -- timezone region not found
ERROR:  timezone region not found
select timestamp '2012-1-1 1:1:1 0010' from dual; -- timezone region not found
ERROR:  timezone region not found
select timestamp '2012-1-1 1:1:1 01 : 10' from dual; -- timezone region not found
ERROR:  timezone region not found
select timestamp '2012-1-1 1:1:1 0110' from dual; -- timezone region not found
ERROR:  timezone region not found
select timestamp '2012-1-1 1:1:1 00' from dual; -- timezone region not found
ERROR:  timezone region not found
select timestamp '2012-1-1 1:1:1 01' from dual; -- timezone region not found
ERROR:  timezone region not found
select timestamp '2012-1-1 1:1:1 +a01' from dual; -- time zone hour must be between -15 and 15
ERROR:  time zone hour must be between -15 and 15
select timestamp '2012-1-1 1:1:1 + a01' from dual; -- time zone hour must be between -15 and 15
ERROR:  time zone hour must be between -15 and 15
select timestamp '2012-1-1 1:1:1 +001:00' from dual; -- time zone hour must be between -15 and 15
ERROR:  time zone hour must be between -15 and 15
select timestamp '2012-1-1 1:1:1 +01:001' from dual; -- time zone minute must be between -59 and 59
ERROR:  time zone minute must be between -59 and 59
select timestamp '2012-1-1 1:1:1 +01 02' from dual; -- literal does not match format string
ERROR:  literal does not match format string
select timestamp '2012-1-1 1:1:1 +09:+15' from dual; -- time zone minute must be between -59 and 59
ERROR:  time zone minute must be between -59 and 59
select timestamp '2012-1-1 1:1:1 +09:-15' from dual; -- time zone minute must be between -59 and 59
ERROR:  time zone minute must be between -59 and 59
select from_tz(to_timestamp('2024-06-03'), '+00 : 10') from dual;
               FROM_TZ                
--------------------------------------
 2024-06-03 00:00:00.000000000 +00:10
(1 row)

select from_tz(to_timestamp('2024-06-03'), '09 : 07') from dual;
               FROM_TZ                
--------------------------------------
 2024-06-03 00:00:00.000000000 +09:07
(1 row)

select from_tz(to_timestamp('2024-06-03'), '+a0 : 10') from dual; -- specified field not found in datetime or interval
ERROR:  specified field not found in datetime or interval
select from_tz(to_timestamp('2024-06-03'), '0907') from dual; -- time zone hour must be between -15 and 15
ERROR:  time zone hour must be between -15 and 15
select from_tz(to_timestamp('2024-06-03'), '+0010') from dual; -- literal does not match format string
ERROR:  literal does not match format string
select to_timestamp_tz('2024-06-03 00:00', 'yyyy-mm-dd tzh:tzm') at time zone '+00 : 10' from dual;
               TIMEZONE               
--------------------------------------
 2024-06-03 00:10:00.000000000 +00:10
(1 row)

select to_timestamp_tz('2024-06-03 00:00', 'yyyy-mm-dd tzh:tzm') at time zone '09 : 07' from dual;
               TIMEZONE               
--------------------------------------
 2024-06-03 09:07:00.000000000 +09:07
(1 row)

select to_timestamp_tz('2024-06-03 00:00', 'yyyy-mm-dd tzh:tzm') at time zone '+a0 : 10' from dual; -- specified field not found in datetime or interval
ERROR:  specified field not found in datetime or interval
select to_timestamp_tz('2024-06-03 00:00', 'yyyy-mm-dd tzh:tzm') at time zone '0907' from dual; -- time zone hour must be between -15 and 15
ERROR:  time zone hour must be between -15 and 15
select to_timestamp_tz('2024-06-03 00:00', 'yyyy-mm-dd tzh:tzm') at time zone '+0010' from dual; -- literal does not match format string
ERROR:  literal does not match format string
select to_char(to_timestamp_tz('+09 : 07','tzr'), 'tzh:tzm') from dual; -- date format picture ends before converting entire input string
ERROR:  date format picture ends before converting entire input string
select to_char(to_timestamp_tz(' +09 : 07','tzr'), 'tzh:tzm') from dual; -- date format picture ends before converting entire input string
ERROR:  date format picture ends before converting entire input string
select to_char(to_timestamp_tz(' +0907','tzr'), 'tzh:tzm') from dual; -- -- take session timezone in opentenbase_ora, 09:07 here
 TO_CHAR 
---------
 +09:07
(1 row)

select to_char(to_timestamp_tz(' +09','tzr'), 'tzh:tzm') from dual; -- +09:00
 TO_CHAR 
---------
 +09:00
(1 row)

select to_char(to_timestamp_tz(' 0907','tzr'), 'tzh:tzm') from dual; -- +09:07
 TO_CHAR 
---------
 +09:07
(1 row)

select to_char(to_timestamp_tz('59 +09:-15','ss tzr'), 'tzh:tzm') from dual; -- +09:15
 TO_CHAR 
---------
 +09:15
(1 row)

select to_char(to_timestamp_tz('59 +09:+15','ss tzr'), 'tzh:tzm') from dual; -- +09:15
 TO_CHAR 
---------
 +09:15
(1 row)

-- end TAPD: 133179417
--start TAPD: 136154243
SET nls_date_format = 'yyyymmdd';
CREATE TABLE t_20241227(i int, j int, k pg_catalog.date);
INSERT INTO t_20241227 VALUES(1,1,'2022-1-1');
SELECT * FROM t_20241227;
 I | J |     K      
---+---+------------
 1 | 1 | 01-01-2022
(1 row)

UPDATE t_20241227 SET j=u.cn FROM
    (SELECT TO_CHAR('760966439') AS CN, pg_catalog.TO_DATE('2020-03-29','YYYY-MM-DD') AS PUT_DATE
    FROM t_20241227 GROUP BY PUT_DATE)U ;
SELECT * FROM t_20241227;
 I |     J     |     K      
---+-----------+------------
 1 | 760966439 | 01-01-2022
(1 row)

DROP TABLE t_20241227;
RESET nls_date_format;
--end TAPD: 136154243
